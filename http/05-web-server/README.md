# 第五章 与HTTP协作的Web服务器

> 2018-11-15 @wsl

## 1. 虚拟主机（Virtual Host，又称虚拟服务器）

HTTP/1.1 规范允许一台 Http 服务器搭建多个 Web 站点。这是利用了虚拟主机的功能。

在相同的IP地址下，由于虚拟主机可以寄存多个不同主机名和域名的Web网站，因此在发送HTTP请求时，必须在Host首部内完整指定主机名或域名的URI。

 

## 2. 代理、网关和隧道

用于通信转发的应用程序，可以配合服务器工作，将请求转发给通信线路上的下一站服务器，并能接收从那台服务器发送的响应再转发给客户端。

- 代理

  一种有转发功能的应用程序，扮演了位于服务器和客户端“中间人”的角色。

  基本行为就是接收客户端发送的请求后转发给其他服务器。代理不改变请求URI。每次通过代理服务器转发请求或响应时，会追加写入Via首部信息。

  **分类**：一种是否使用缓存，另一种是是否会修改报文。

  - 缓存代理

  - 透明代理


- 网关

  转发其他服务器通信数据的服务器。

  工作机制和代理十分相似。而网关能使通信线路上的服务器提供非HTTP协议服务。

  利用网关能提高通信的安全性，因为可以在客户端与网关之间的通信线路上加密以确保连接的安全。


- 隧道

  在相隔甚远的客户端和服务器两者之间进行中转，并保持双方通信连接的应用程序。

  可按要求建立起一条与其他服务器的通信线路，届时使用SSL等加密手段进行通信。隧道的目的是确保客户端能与服务器进行安全的通信。

  隧道本身不会解析HTTP请求，是透明的。

 

## 3. 缓存

缓存是指代理服务器或客户端本地磁盘内保存的资源副本。利用缓存可减少对源服务器的访问，因此也就节省了通信流量和通信时间。

- 代理服务器的缓存：

  资源更新、客户端的要求、缓存的有效期等因素，影响着代理服务器缓存资源的有效性。若判断缓存失效，需要重新向源服务器请求新资源。

- 客户端的缓存：

  缓存不仅可以存在于缓存服务器内，还可以存在于客户端浏览器中。

  判断缓存过期后，会向源服务器确认资源的有效性。若判断缓存失效，会再次请求新资源。