# 用户权限管理

> 2020.03.30 @wsl

## RBAC

### 概念

RBAC（Role-Based Access Control）基于角色的访问控制。这是从传统的权限模型基础上，改进而来并且相当成熟的权限模型。这里强调三个要素：用户、角色、权限。用户与角色是多对多关系，角色与权限是多对多关系。

传统模型中无角色概念，直接为用户赋上权限，一是导致配置权限相当麻烦，二来无法快速为多个用户批量删除权限。用户—角色—权限多对多的关系，解决了这些问题。

关键元素：

- **用户：**成功认证并登录系统的操作员（主体：who）
- **权限：**访问资源的许可（how）
- **角色：**权限的集合体
- **资源：**包括系统菜单、页面、按钮等（what）

主体（who）如何通过权限（how）访问资源(what resource)。

权限是用来访问资源的，为用户赋予权限，则可访问资源；在权限基础上，将权限打包为一个权限集合—角色，如财务经理角色，则为用户赋上财务经理角色，用户可访问财务经理角色下的资源集合。



### RBAC模型

根据RBAC的复杂度不同，可分为RBAC0，RBAC1，RBAC2，RBAC3。最常用的为RBAC0。

#### RBAC0模型

将一个或多个权限挂到角色下，在将一个或多个角色赋予用户，权限与角色的关系，角色与用户的关系，均是多对多的关系。

场景。为财务经理岗建立财务经理角色，将对账、付款审批、回款确认等权限配置在财务经理角色下，则公司再更换财务经理人员，只需每次为新来的财务经理配置财务经理角色。

#### RBAC1模型

引入继承概念，一个角色可以从另一个角色继承许可权。角色间的继承关系可分为一般继承关系和受限继承关系。一般继承关系允许角色间的多继承，受限继承关系则进一步要求角色继承关系是一个树结构。

场景。适用于角色之间的层次明确，如总经理与副总经理，业务部门如总经理–团队经理–业务员。也适用于用户分级管理，初级用户只能使用部分功能，中级用户能够使用更多功能。

#### RBAC2模型

加入了角色的访问控制。规定了权限被赋予角色时，或角色被赋予用户时，以及当用户在某一时刻激活一个角色时所应遵循的强制性规则。

包括静态职责分离SSD(Static Separation of Duty)和动态职责分离DSD(Dynamic DSD(Dynamic Separation of Duty)。

- **互斥角色 ：**同一用户只能分配到一组互斥角色集合中至多一个角色，支持责任分离的原则。案例：在审计活动中，一个角色不能同时被指派给会计角色和审计员角色。
- **基数约束 ：**一个角色被分配的用户数量受限；一个用户可拥有的角色数目受限；一个角色的权限数目受限。案例：如VP类角色不可随意分配给多个用户。
- **先决条件角色 ：**指要想获得较高的权限，要首先拥有低一级的权限。案例：先有副总经理全下，才能有总经理权限。
- **运行时互斥** ：例如，允许一个用户具有两个角色，但不可同时激活这两个角色。

#### RBAC3模型

RBAC1+RBAC2的集合体。即支持角色间的继承关系，又支持角色间的责任分离关系。一般无需如此全面负责的模型。

### 常见的常规管理功能

**（1）用户管理**

用户按架构新建在对应的组织上。一般挂到机构→部门（一级部门–二级部门）下。

对于公司内部管理系统，管理用户的前提，是需要合理的组织架构，只有支持组织架构的灵活配置，才能进一步支持组织内人员的增删调整。

**（2）角色管理**

所有角色的管理功能。新建角色时，可将角色建立在某级机构或机构及以下，代表此角色只能适用此级别或此级别以下级别。

**（3）菜单管理（有的后台叫栏目管理）**

支持自主配置菜单一级二级，支持新增菜单、修改菜单、删除菜单，更改菜单（修改菜单名、菜单顺序等），每个菜单对应一个权限。

**（4）组管理**

用户所属组，用于配置统一组同一部门用户。有了用户组，在新建角色时，可直接将角色赋予某个组，则进入此组的人员自动获得对应角色。



## 参考链接

[后台设计的基石：用户权限管理（RBAC）及工作流（workflow ...](http://www.woshipm.com/pd/959125.html)

[RBAC权限管理](https://blog.csdn.net/painsonline/article/details/7183613/)