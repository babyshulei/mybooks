# æ­£åˆ™è¡¨è¾¾å¼

## æ¦‚å¿µ

æ­£åˆ™è¡¨è¾¾å¼æ˜¯ç”¨äºåŒ¹é…å­—ç¬¦ä¸²ä¸­å­—ç¬¦ç»„åˆçš„æ¨¡å¼ï¼Œåœ¨ JavaScriptä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæ˜¯å¯¹è±¡ã€‚

- æ­£åˆ™è¡¨è¾¾å¼æ˜¯åœ¨å®¿ä¸»ç¯å¢ƒä¸‹è¿è¡Œçš„ï¼Œå¦‚`js/php/node.js` ç­‰

## åŸºç¡€çŸ¥è¯†

### åˆ›å»ºæ­£åˆ™

JavaScriptä¸­å¯ä»¥é€šè¿‡å­—é¢é‡å’Œå¯¹è±¡ä¸¤ç§æ–¹å¼åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ã€‚

#### å­—é¢é‡åˆ›å»º

è¯­æ³•ï¼š

```js
/pattern/flags
```

å‚æ•°ï¼š

- pattern
  å­—ç¬¦ä¸²ï¼ŒæŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼çš„æ¨¡å¼
- flags
  å¯é€‰å‚æ•°ï¼Œå¦‚gã€iã€mç­‰ï¼Œåˆ†åˆ«è¡¨ç¤ºæ˜¯è¿›è¡Œå…¨å±€åŒ¹é…ã€ä¸åŒºåˆ†å¤§å°å†™åŒ¹é…ã€å¤šè¡ŒåŒ¹é…ç­‰

è¯¥æ–¹å¼è¾ƒä¸ºå¸¸ç”¨ï¼Œä½†ä¸èƒ½åœ¨å…¶ä¸­ä½¿ç”¨å˜é‡ã€‚è™½ç„¶å¯ä»¥ä½¿ç”¨`eval`è½¬æ¢ä¸ºjsè¯­æ³•æ¥å®ç°ï¼Œä½†æ˜¯æ¯”è¾ƒéº»çƒ¦ï¼Œæ›´å»ºè®®æœ‰å˜é‡æ—¶ä½¿ç”¨å¯¹è±¡åˆ›å»ºè¯­æ³•ã€‚

ç¤ºä¾‹ï¼š

```js
let str = 'sdkfjdkf';
console.log(/s/.test(str)); // true
```

#### å¯¹è±¡åˆ›å»º

è¯­æ³•ï¼š

```js
new RegExp(pattern, flags)
```

ç¤ºä¾‹ï¼š

```js
const con = prompt('è¯·è¾“å…¥è¦æœç´¢çš„å†…å®¹ï¼Œæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼');
const reg = new RegExp(con, 'g');
let div = document.querySelector('#content');
div.innerHTML = div.innerHTML.replace(reg, str => {
    return `<span style="color: red">str</span>`;
})
```

### é€‰æ‹©ç¬¦

`|` è¿™ä¸ªç¬¦å·ä»£è¡¨é€‰æ‹©ç¬¦ï¼Œå·¦å³ä¸¤ä¾§æœ‰ä¸€ä¸ªåŒ¹é…åˆ°å³å¯ã€‚

ç¤ºä¾‹ï¼š

```js
const str = 'hello world';
const reg = /one|hello/;
console.log(reg.test(str)); // true;
```

> åŸå­è¡¨`[]`ï¼ŒåŒ¹é…ä»»ä¸€å­—ç¬¦ï¼Œæš—å«é€‰æ‹©åŒ¹é…ï¼Œä¸ç”¨åŠ `|`ï¼Œå¦‚ `/[1234]/`è¡¨ç¤ºåŒ¹é…1234ä¸­ä»»æ„å­—ç¬¦ã€‚
>
> åŸå­ç»„`()`ï¼Œä¸€æ¬¡åŒ¹é…å¤šä¸ªå…ƒå­ï¼Œå¦‚æœæƒ³è¦é€‰æ‹©åŒ¹é…éœ€è¦åŠ `|`ï¼Œå¦‚`/(123|345)/`è¡¨ç¤ºåŒ¹é…123æˆ–345ã€‚

### å­—ç¬¦è½¬ä¹‰

è½¬ä¹‰ç”¨äºæ”¹å˜å­—ç¬¦çš„å«ä¹‰ï¼Œç”¨æ¥å¯¹æŸä¸ªå­—ç¬¦æœ‰å¤šç§è¯­ä¹‰æ—¶çš„å¤„ç†ã€‚

è¯­æ³•ï¼šåœ¨å­—ç¬¦å‰åŠ ä¸Šè½¬ä¹‰å­—ç¬¦ `\` å³å¯ã€‚

ç¤ºä¾‹ï¼š

```js
const num1 = 3344;
const num2 = 22.53;
// å­—é¢é‡åœºæ™¯
const reg1 = /\d+\.\d+/;
// å¯¹è±¡åœºæ™¯
// ç”±äºå­—ç¬¦ä¸²é‡Œï¼Œ\ä¹Ÿæ˜¯ç‰¹æ®Šå­—ç¬¦ï¼Œæ‰€ä»¥è¦å†åŠ ä¸€ä¸ªè½¬ä¹‰å­—ç¬¦ï¼Œç”Ÿæˆçš„æ­£åˆ™æ‰æ˜¯/\d+\.\d+/
const reg2 = new RegExp('\\d+\\.\\d+');
console.log(reg1.test(num1), reg1.test(num2)); // false true
console.log(reg2.test(num1), reg2.test(num2)); // false true
```

### å­—ç¬¦è¾¹ç•Œ

ä½¿ç”¨å­—ç¬¦è¾¹ç•Œç¬¦ç”¨äºæ§åˆ¶åŒ¹é…å†…å®¹çš„å¼€å§‹ä¸ç»“æŸçº¦å®šã€‚

| è¾¹ç•Œç¬¦ | è¯´æ˜                         |
| ------ | ---------------------------- |
| ^      | åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹             |
| $      | åŒ¹é…å­—ç¬¦ä¸²çš„ç»“æŸï¼Œå¿½ç•¥æ¢è¡Œç¬¦ |

ç¤ºä¾‹ï¼š

```js
// è¾“å…¥å€¼åªåŒ¹é…3-6ä½å­—æ¯
document.querySelector('input').addEventListener('keyup', function() {
    let value = this.value;
    let reg = /^[a-z]{3,6}$/i;
    console.log(value.match(reg) ? 'æ­£ç¡®' : 'é”™è¯¯');
});
```

## å…ƒå­å­—ç¬¦

å…ƒå­å­—ç¬¦æ˜¯æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„æœ€å°å…ƒç´ ï¼Œåªä»£è¡¨å•ä¸€ï¼ˆä¸€ä¸ªï¼‰å­—ç¬¦ã€‚

| å…ƒå­—ç¬¦ | è¯´æ˜                                                 | ç¤ºä¾‹          |
| ------ | ---------------------------------------------------- | ------------- |
| \d     | åŒ¹é…ä»»æ„ä¸€ä¸ªæ•°å­—                                     | [0-9]         |
| \D     | ä¸é™¤äº†æ•°å­—ä»¥å¤–çš„ä»»ä½•ä¸€ä¸ªå­—ç¬¦åŒ¹é…                     | [^0-9]        |
| \w     | ä¸ä»»æ„ä¸€ä¸ªè‹±æ–‡å­—æ¯ã€æ•°å­—æˆ–ä¸‹åˆ’çº¿åŒ¹é…                 | [a-zA-Z_]     |
| \W     | é™¤äº†å­—æ¯ã€æ•°å­—æˆ–ä¸‹åˆ’çº¿å¤–ä¸ä»»ä½•å­—ç¬¦åŒ¹é…               | [^a-zA-Z_]    |
| \s     | ä»»æ„ä¸€ä¸ªç©ºç™½å­—ç¬¦åŒ¹é…ï¼Œå¦‚ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦`\t`ï¼Œæ¢è¡Œç¬¦`\n` | [\n\f\r\t\v]  |
| \S     | é™¤äº†ç©ºç™½ç¬¦å¤–ä»»æ„ä¸€ä¸ªå­—ç¬¦åŒ¹é…                         | [^\n\f\r\t\v] |
| .      | åŒ¹é…é™¤æ¢è¡Œç¬¦å¤–çš„ä»»æ„å­—ç¬¦                             |               |

åŒ¹é…æ‰€æœ‰å­—ç¬¦ï¼š

- `/[\s\S]+/`
- `/[\d\D]+/`
- `/[\w\W]+/`
- `/.+/s`
- `/[^]+/`

## æ¨¡å¼ä¿®é¥°

æ­£åˆ™è¡¨è¾¾å¼æœ‰å…­ä¸ªå¯é€‰å‚æ•° (`flags`) å…è®¸å…¨å±€å’Œä¸åˆ†å¤§å°å†™æœç´¢ç­‰ã€‚è¿™äº›å‚æ•°æ—¢å¯ä»¥å•ç‹¬ä½¿ç”¨ä¹Ÿèƒ½ä»¥ä»»æ„é¡ºåºä¸€èµ·ä½¿ç”¨, å¹¶ä¸”è¢«åŒ…å«åœ¨æ­£åˆ™è¡¨è¾¾å¼å®ä¾‹ä¸­ã€‚

| ä¿®é¥°ç¬¦ | è¯´æ˜                                                        |
| ------ | ----------------------------------------------------------- |
| i      | ä¸åŒºåˆ†å¤§å°å†™å­—æ¯çš„åŒ¹é…                                      |
| g      | å…¨å±€æœç´¢æ‰€æœ‰åŒ¹é…å†…å®¹                                        |
| m      | è§†ä¸ºå¤šè¡Œ                                                    |
| s      | è§†ä¸ºå•è¡Œå¿½ç•¥æ¢è¡Œç¬¦ï¼Œä½¿ç”¨`.` å¯ä»¥åŒ¹é…æ‰€æœ‰å­—ç¬¦                |
| y      | æ‰§è¡Œâ€œç²˜æ€§ï¼ˆstickyï¼‰â€æœç´¢ï¼Œä» `regexp.lastIndex` å¼€å§‹åŒ¹é…    |
| u      | ä½¿ç”¨unicodeç çš„æ¨¡å¼è¿›è¡ŒåŒ¹é…ï¼Œæ­£ç¡®å¤„ç†å››ä¸ªå­—ç¬¦çš„ UTF-16 ç¼–ç  |

ç¤ºä¾‹ï¼šç»™å®šå¤šè¡Œå­—ç¬¦ä¸²ï¼Œè¿”å› { name, price }çš„æ•°ç»„ã€‚

```js
let hd = `
  #1 js,200å…ƒ #
  #2 php,300å…ƒ #
  #9 houdunren.com # åç›¾äºº
  #3 node.js,180å…ƒ #
`;
let reg = /^\s*#\d+\s.+\s#$/mg;
let result = hd.match(reg).map(v => {
    let str = v.replace(/\s*#\d+\s/, '').replace(/\s#/, '');
    let [name, price] = str.split(',');
    return {name, price};
});
console.log(JSON.stringify(result, null, 2));
```

### g

å…¨å±€åŒ¹é…ã€‚

ç¤ºä¾‹ï¼š

```js
let str = 'hello';
let reg = /\w/g;
console.log(str.match(reg)); // ["h", "e", "l", "l", "o"]
```

### u

æ¯ä¸ªå­—ç¬¦éƒ½æœ‰å±æ€§ï¼Œåœ¨ u æ¨¡å¼ä¸‹ï¼Œå¯ä»¥æ ¹æ®å±æ€§æ¥è¿›è¡Œå­—ç¬¦åŒ¹é…ï¼Œå¦‚ P ä»£è¡¨æ ‡ç‚¹ç¬¦å·ã€L ä»£è¡¨å­—æ¯ï¼Œå‚è§ï¼š[å±æ€§çš„åˆ«å](https://www.unicode.org/Public/UCD/latest/ucd/PropertyValueAliases.txt)ã€‚

å­—ç¬¦ä¹Ÿæœ‰unicodeæ–‡å­—ç³»ç»Ÿå±æ€§ï¼Œå¦‚Hanä»£è¡¨ä¸­æ–‡å­—ç¬¦ï¼Œå‚è§ï¼š[æ–‡å­—è¯­è¨€è¡¨](http://www.unicode.org/standard/supported.html)ã€‚

`u`æ¨¡å¼å¯ä»¥æ­£ç¡®å¤„ç†4ä¸ªå­—ç¬¦çš„ UTF-16 å­—èŠ‚ç¼–ç ã€‚

ç¤ºä¾‹ï¼š

```js
var str = 'Hello!æ¬¢è¿æ¥åˆ°æ–°ä¸–ç•Œï¼Œ^_^ã€‚ğ’³ğ’´';
var reg1 = /\p{P}/ug;
var reg2 = /\p{L}/ug;
var reg3 = /\p{sc=Han}/ug;
var reg4 = /[ğ’³ğ’´]/ug;
console.log(str.match(reg1)); // ["!", "ï¼Œ", "_", "ã€‚"]
console.log(str.match(reg2)); // ["H", "e", "l", "l", "o", "æ¬¢", "è¿", "æ¥", "åˆ°", "æ–°", "ä¸–", "ç•Œ", "ğ’³", "ğ’´"]
console.log(str.match(reg3)); // ["æ¬¢", "è¿", "æ¥", "åˆ°", "æ–°", "ä¸–", "ç•Œ"]
console.log(str.match(reg4)); // ["ğ’³", "ğ’´"]
```

### y

ç²˜æ€§åŒ¹é…ï¼Œä»lastIndexå¤„å¼€å§‹åŒ¹é…ï¼Œéœ€è¦ä¸€ç›´ç¬¦åˆåŒ¹é…æ¡ä»¶æ‰èƒ½ç»§ç»­æœç´¢ã€‚

```js
var str = 'testhhhaha';
var reg = /h/y;
var res;
console.log(reg.exec(str), reg.lastIndex);
reg.lastIndex = 4;
while((res = reg.exec(str))) {
    console.log(res[0], reg.lastIndex);
}

// null 0
// h 5
// h 6
// h 7
```

ç”¨é€”ï¼š

y æ¨¡å¼æ¯”è¾ƒé€‚ç”¨è¿ç»­ä¸”çŸ¥æ™“ä½ç½®çš„å¤§æ–‡ä»¶æœç´¢ï¼Œç›¸æ¯”äº g æ¨¡å¼ï¼Œå¯ä»¥æå‡æ•ˆç‡ï¼Œä¸ç”¨æŸ¥æ‰¾æ•´ä¸ªæ–‡ä»¶å³å¾—åˆ°åŒ¹é…ç»“æœã€‚

### lastIndex

RegExpå¯¹è±¡çš„lastIndexå±æ€§å¯ä»¥è¿”å›æˆ–è®¾ç½®å¼€å§‹åŒ¹é…çš„ç´¢å¼•ã€‚

- å¿…é¡»ç»“åˆ `g`ä¿®é¥°ç¬¦ä½¿ç”¨
- å¯¹ `reg.exec()` æ–¹æ³•æœ‰æ•ˆ
- åŒ¹é…å®Œæˆæ—¶ï¼Œ`lastIndex` ä¼šç½®ä¸º 0

ç¤ºä¾‹ï¼š

```js
var str = 'test';
var reg = /\w/g;
var res;
while((res = reg.exec(str))) {
    console.log(res[0], reg.lastIndex);
}
console.log(res, reg.lastIndex);
// "t" 1
// "e" 2
// "s" 3
// "t" 4
// null 0
```

## åŸå­è¡¨

åœ¨ä¸€ç»„å­—ç¬¦ä¸­åŒ¹é…æŸä¸ªå…ƒå­—ç¬¦ï¼Œåœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­é€šè¿‡å…ƒå­—ç¬¦è¡¨æ¥å®Œæˆï¼Œå³æ”¾åˆ° `[]` ä¸­ã€‚

#### ä½¿ç”¨è¯­æ³•

| åŸå­è¡¨ | è¯´æ˜                               |
| ------ | ---------------------------------- |
| []     | åªåŒ¹é…å…¶ä¸­çš„ä¸€ä¸ªåŸå­               |
| [^]    | åªåŒ¹é…"é™¤äº†"å…¶ä¸­å­—ç¬¦çš„ä»»æ„ä¸€ä¸ªåŸå­ |
| [0-9]  | åŒ¹é…0-9ä»»ä½•ä¸€ä¸ªæ•°å­—                |
| [a-z]  | åŒ¹é…å°å†™a-zä»»ä½•ä¸€ä¸ªå­—æ¯            |
| [A-Z]  | åŒ¹é…å¤§å†™A-Zä»»ä½•ä¸€ä¸ªå­—æ¯            |

ç¤ºä¾‹ï¼š

```js
var str = 'testhhaha';
var reg1 = /[hs]/g;
var reg2 = /[^a-e]/g;
console.log(str.match(reg1)); // ["s", "h", "h", "h"]
console.log(str.match(reg2)); // ["t", "s", "t", "h", "h", "h"]
```

ç¤ºä¾‹ï¼ŒåŒ¹é…æ—¥æœŸï¼š

```js
var date1 = '2004-12-20';
var date2 = '2004/12-20';
var reg = /^\d{4}([\/-])\d{2}\1\d{2}$/;
console.log(reg.test(date1), reg.test(date2)); // true false
// æ³¨æ„ï¼šæ­£åˆ™è¡¨è¾¾å¼ä¸­çš„\1æ˜¯ç”¨äº†åŸå­ç»„çš„æ–¹å¼ï¼Œä¿è¯å‰åä¸¤ä¸ªç¬¦å·ä¸€è‡´
```

#### åŒºé—´åŒ¹é…

åŒºé—´åŒ¹é…å°±æ˜¯`[0-9]`è¿™ç§ï¼ŒåŒ¹é…ä¸€ä¸ªèŒƒå›´å†…çš„ä»»ä¸€å­—ç¬¦ï¼Œæ³¨æ„ï¼Œå¿…é¡»æ˜¯å‡åºåŒºé—´ï¼Œé™åºåŒºé—´ä¼šæŠ¥é”™ã€‚

ç¤ºä¾‹ï¼š

```js
const str = "e";
console.log(/[a-f]/.test(str)); //true
```

#### æ’é™¤åŒ¹é…

æ’é™¤åŒ¹é…æ˜¯ `[^]` è¿™ç§è¯­æ³•ï¼Œè¡¨ç¤ºåŒ¹é…é™¤äº†è¡¨ä¸­å­—ç¬¦çš„ä»»ä¸€å­—ç¬¦ã€‚

ç¤ºä¾‹ï¼ŒåŒ¹é…ä¸­æ–‡ï¼š

```js
var str = 'çœŸå¥½:16353-3848347,å¤©å¤©:3483784-2837';
console.log(str.match(/[^\d:\-,]/g)); // ["çœŸ", "å¥½", "å¤©", "å¤©"]
// æ³¨æ„ï¼Œæ­¤æ—¶-å­—ç¬¦éœ€è¦è½¬ä¹‰ï¼Œå› ä¸ºè¿™ä¸ª-å¯èƒ½è¡¨ç¤ºåŒºé—´ï¼Œå¦‚a-z
```



>æ³¨æ„ï¼ŒåŸå­è¡¨ä¸­ï¼Œæœ‰äº›æ­£åˆ™å­—ç¬¦ä¸éœ€è¦è½¬ä¹‰ï¼Œç›´æ¥é»˜è®¤ä¸ºå¯¹åº”å­—ç¬¦ã€‚
>
>ç¤ºä¾‹ï¼š
>
>```js
>var str = '(ss).ww.co';
>console.log(str.match(/[().\w]/g)); // Â ["(", "s", "s", ")", ".", "w", "w", ".", "c", "o"]
>```













## å‚è€ƒèµ„æ–™

[æ­£åˆ™è¡¨è¾¾å¼- ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦](https://zh.wikipedia.org/wiki/æ­£åˆ™è¡¨è¾¾å¼)

[æ­£åˆ™è¡¨è¾¾å¼- JavaScript | MDN](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions)

[JavaScript || æ­£åˆ™è¡¨è¾¾å¼ - segmentfault](https://segmentfault.com/a/1190000008729041)

[RegExp - å»–é›ªå³°](http://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000/001434499503920bb7b42ff6627420da2ceae4babf6c4f2000)

[æ·±å…¥æµ…å‡ºçš„javascriptçš„æ­£åˆ™è¡¨è¾¾å¼å­¦ä¹ æ•™ç¨‹](http://www.cnblogs.com/tugenhua0707/p/5037811.html#_labe1)

[æ­£åˆ™è¡¨è¾¾å¼ - åç›¾äºº](https://houdunren.gitee.io/note/js/14%20æ­£åˆ™è¡¨è¾¾å¼.html)

[æ­£åˆ™è¡¨è¾¾å¼ - bilibili](https://www.bilibili.com/video/BV12J41147fC?p=1)

