# 数组

## 概念

数组（Array）是一种线性表数据结构。它用一组连续的内存空间，来存储一组具有相同类型的数据。

> 注：不同语言的数组实现方式具有一定差别，如在C++ 和 Java 中，数组中的元素类型必须保持一致，而 Python 中则可以不同。

## 操作

### 读取元素

由于数组的这些特性，数组可以实现随机访问。通过**索引**，可以直接获取值，时间复杂度为O(1)。

在C语言等语言中，数组越界有不同的处理方案，会造成不同的后果，代码中要避免出现数组越界的情况。

**为什么大多数编程语言中，数组要从 0 开始编号，而不是从 1 开始呢？**

a[k]的内存地址公式：

```
a[k]_address = base_address + k * type_size
```

客观原因：如果数组索引从1开始，则计算公式的 k 变为 k+1 ，每次取值时要多进行一次加法运算。为了尽量优化性能，数组索引是从0开始的。

历史原因：C语言设计时，数组索引从0开始的。后面其他语言在设计时，也沿用了该习惯。也有不是从0计数的，如Matlab；还有负数的索引，如Python。

### 查找元素

查找元素，需要从数组开头逐步向后查找，直到匹配到目标元素，否则一直进行查找直到数组的末尾。可以看到，查找元素的时间复杂度为O(n)。

如果数组是有序的，或者知道元素的位置，那么查找元素的时间复杂度将大大降低。

### 插入元素

插入元素需要根据数组的长度和插入的位置进行计算，如果是数组尾部，直接插入到指定位置即可；如果是数组中其他位置，需要将位置后的元素向后平移，再将元素插入到指定位置。

可以看到，插入的操作时间复杂度为O(n)。

### 删除元素

删除元素与插入元素的操作类似，当删除指定位置的元素后，需要将后面的元素向前平移，以保证数组的连续性。删除的时间复杂度同样为O(n)。

## 优缺点分析

- 数组这种结构比较适合于查找，知道索引位置的话，取值的时间复杂度为O(1)。

- 插入、删除值比较低效，平均时间复杂度为O(n)。
  如果数组是无序的，插入可以进行优化：插入所对应的原索引值直接添加到数组尾部。删除的优化：将删除的值进行标记，在数组空间将满时，统一进行删除。其实这就是JVM的垃圾回收机制。
- 扩容问题。数组定义时需要指定大小，分配连续的内存空间。当存储内容超过了一定范围，需要进行扩容操作，此时要重新分配一块更大的空间，将原来的数据复制过去。扩容操作涉及内存申请和数据搬移，是比较耗时的。



## 二维数组

二维数组是一种结构较为特殊的数组，只是将数组中的每个元素变成了一维数组。

所以二维数组的本质仍然是一个一维数组，内部的一维数组仍然从索引0开始。

可以看做一个矩阵，用来处理矩阵相关的问题。如矩阵选择、对角线遍历、对子矩阵的操作等。



## JavaScript数组

在 JavaScript 中，数组是哈希映射。它可以通过多种数据结构实现，其中一种是链表。

JavaScript 引擎会进行优化，为同种数据类型的数组分配连续的存储空间。

 JavaScript 中引入类型化数组，使用ArrayBuffer、TypeArray，改进了数组的性能。



## 参考链接

[05 | 数组：为什么很多编程语言中数组都从0开始编号？](https://time.geekbang.org/column/article/40961)

[深究 JavaScript 数组 —— 演进&性能](https://juejin.cn/post/6844903494189580302)

[Diving deep into JavaScript array - evolution & performance](http://link.zhihu.com/?target=http%3A//voidcanvas.com/javascript-array-evolution-performance/)

[数组和字符串 - LeetCode](https://leetcode-cn.com/leetbook/detail/array-and-string/)

