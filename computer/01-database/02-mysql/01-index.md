# 索引

索引类似大学图书馆建书目索引，可以提高数据检索的效率，降低数据库的IO成本。[MySQL](https://www.linuxidc.com/topicnews.aspx?tid=21)在300万条记录左右性能开始逐渐下降，虽然官方文档说500~800w记录，所以大数据量建立索引是非常有必要的。MySQL提供了Explain，用于显示SQL执行的详细信息，可以进行索引的优化。

## 概念

MySQL官方对索引的定义为：索引(Index)是帮助MySQL高效获取数据的数据结构。我们可以简单理解为：快速查找排好序的一种数据结构。Mysql索引主要有两种结构：B+Tree索引和Hash索引。

我们平常所说的索引，如果没有特别指明，一般都是指B树结构组织的索引(B+Tree索引)。如图：

![img](..\images\index-b-tree.jpg)

最外层浅蓝色磁盘块1里有数据17、35（深蓝色）和指针P1、P2、P3（黄色）。P1指针表示小于17的磁盘块，P2是在17-35之间，P3指向大于35的磁盘块。真实数据存在于子叶节点也就是最底下的一层3、5、9、10、13……非叶子节点不存储真实的数据，只存储指引搜索方向的数据项，如17、35。

查找过程：例如搜索28数据项，首先加载磁盘块1到内存中，发生一次I/O，用二分查找确定在P2指针。接着发现28在26和30之间，通过P2指针的地址加载磁盘块3到内存，发生第二次I/O。用同样的方式找到磁盘块8，发生第三次I/O。

真实的情况是，上面3层的B+Tree可以表示上百万的数据，上百万的数据只发生了三次I/O而不是上百万次I/O，时间提升是巨大的。

## 是否需要建索引？

索引虽然能非常高效的提高查询速度，同时却会降低更新表的速度。实际上索引也是一张表，该表保存了主键与索引字段，并指向实体表的记录，所以索引列也是要占用空间的。

![img](..\images\whether-need-index.jpg)



## 参考链接

[MySQL 如何创建索引及优化](https://www.linuxidc.com/Linux/2018-06/152757.htm)

[数据库索引- 维基百科，自由的百科全书](https://zh.wikipedia.org/zh-hans/数据库索引)

[MySQL 数据库索引使用场景&注意事项- 简书](https://www.jianshu.com/p/aedf4c0972e8)

[Indexes - 索引 - Sequelize](https://demopark.github.io/sequelize-docs-Zh-CN/other-topics/indexes.html)

